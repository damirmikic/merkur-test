<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Odds Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body class="bg-gray-100 text-slate-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <div class="max-w-6xl mx-auto bg-white rounded-xl border border-slate-200 shadow-sm">
            <header class="p-6 sm:p-8 flex items-center justify-between border-b border-slate-200">
                 <div class="flex items-center gap-4">
                    <div class="bg-blue-100 text-blue-600 p-3 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calculator"><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x1="16" y1="14" y2="18"/><line x1="16" x1="12" y1="14" y2="14"/><line x1="12" x1="12" y1="14" y2="18"/><line x1="8" x1="8" y1="10" y2="18"/><line x1="8" x1="12" y1="10" y2="10"/></svg>
                    </div>
                    <h1 class="text-2xl sm:text-3xl font-bold text-slate-800">Generator Kvota</h1>
                 </div>
                 <div class="flex items-center gap-4">
                    <div id="status-container" class="flex items-center gap-2.5 text-sm font-medium">
                        <div id="status-indicator" class="w-2.5 h-2.5 rounded-full bg-red-500" title="Status učitavanja baze podataka"></div>
                        <span id="status-text" class="text-slate-500">Učitavanje...</span>
                    </div>
                 </div>
            </header>

            <div class="border-b border-slate-200">
                <nav class="flex -mb-px px-6 sm:px-8">
                    <button class="tab-btn active" data-tab="players">Igrači</button>
                    <button class="tab-btn" data-tab="specials">Specijal</button>
                </nav>
            </div>
            
            <div class="p-6 sm:p-8">
                <div class="mb-8">
                    <button type="button" id="fetch-api-btn" class="action-btn secondary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-download"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                        <span id="api-btn-text">Učitaj Mečeve sa API-ja</span>
                    </button>
                    <p id="api-status" class="text-sm text-slate-500 mt-2 h-5"></p>
                </div>

                <div id="tab-players" class="tab-content active">
                    <section id="api-section" class="mb-8 p-6 bg-slate-50 border border-slate-200 rounded-lg">
                        <h3 class="font-bold text-lg text-slate-800 mb-4">Preuzimanje Podataka za Igrače</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-end">
                            <div class="input-group">
                                <label for="competition-select">Takmičenje</label>
                                <select id="competition-select" disabled></select>
                            </div>
                            <div class="input-group">
                                <label for="event-select">Meč</label>
                                <select id="event-select" disabled></select>
                            </div>
                        </div>
                    </section>
                    
                    <section id="match-details-section" class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 hidden">
                        <div class="input-group md:col-span-1"><label for="match-name">Naziv Utakmice</label><input type="text" id="match-name"></div>
                        <div class="grid grid-cols-2 gap-6">
                            <div class="input-group"><label for="kickoff-date">Datum početka</label><input type="date" id="kickoff-date"></div>
                            <div class="input-group"><label for="kickoff-time">Vreme početka</label><input type="time" id="kickoff-time"></div>
                        </div>
                    </section>
                    
                    <form id="odds-form">
                        <section class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end mb-8">
                             <div class="input-group">
                                <label for="team-select">Tim</label>
                                <select id="team-select" disabled></select>
                            </div>
                            <div class="input-group"><label for="team-win-odd">Kvota na Pobedu</label><input type="number" id="team-win-odd" step="0.01" value="1.85"></div>
                            <div class="input-group"><label for="bookmaker-margin">Margina (%)</label><input type="number" id="bookmaker-margin" step="0.1" value="10"></div>
                        </section>
                        <section class="border-t border-slate-200 pt-8">
                            <div id="players-section-header" class="flex flex-wrap justify-between items-end gap-4 mb-6">
                                <h3 class="text-xl font-bold text-slate-700 w-full sm:w-auto">Igrači</h3>
                                <div class="flex flex-col sm:flex-row gap-4 w-full sm:w-auto">
                                    <div id="api-player-adder" class="flex items-end gap-2 hidden">
                                         <div class="input-group flex-grow">
                                            <label for="api-player-select">Dodaj igrača iz ponude</label>
                                            <select id="api-player-select"></select>
                                         </div>
                                         <button type="button" id="add-api-player-btn" class="h-10 px-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow-md transition-all transform hover:scale-105 flex-shrink-0" title="Dodaj izabranog igrača">
                                             <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                                         </button>
                                    </div>
                                    <div class="input-group max-w-xs">
                                        <label for="team-filter">Filtriraj po Ekipi (iz baze)</label>
                                        <select id="team-filter"></select>
                                    </div>
                                </div>
                            </div>
                            <div id="players-container" class="space-y-6"></div>
                        </section>
                        <div class="flex justify-center mt-6 mb-8"><button type="button" id="add-player-btn" class="flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-all transform hover:scale-105"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg> Dodaj Igrača Ručno</button></div>
                    </form>
                </div>

                <div id="tab-specials" class="tab-content">
                    <form id="specials-form">
                         <section id="special-api-section" class="mb-8 p-6 bg-slate-50 border border-slate-200 rounded-lg hidden">
                            <h3 class="font-bold text-lg text-slate-800 mb-4">Izbor Meča za Specijal (Cloudbet)</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-end">
                                <div class="input-group">
                                    <label for="special-competition-select">Takmičenje</label>
                                    <select id="special-competition-select" disabled></select>
                                </div>
                                <div class="input-group">
                                    <label for="special-event-select">Meč</label>
                                    <select id="special-event-select" disabled></select>
                                </div>
                            </div>
                        </section>
                         <section id="special-params-section" class="mb-8 p-6 bg-slate-50 border border-slate-200 rounded-lg">
                            <h3 class="font-bold text-lg text-slate-800 mb-4">Parametri za Specijal</h3>
                             <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6">
                                <div class="input-group"><label for="special-goals-lambda">Oč. Golova (λ)</label><input type="number" id="special-goals-lambda" step="0.1" value="2.5"></div>
                                <div class="input-group"><label for="special-goals-lambda-home">Oč. Golova Domaćin</label><input type="number" id="special-goals-lambda-home" step="0.1" readonly></div>
                                <div class="input-group"><label for="special-goals-lambda-away">Oč. Golova Gost</label><input type="number" id="special-goals-lambda-away" step="0.1" readonly></div>
                                 <div class="input-group"><label for="special-corners-lambda">Oč. Kornera (λ)</label><input type="number" id="special-corners-lambda" step="0.1" value="10.5"></div>
                                <div class="input-group"><label for="special-cards-lambda">Oč. Kartona (λ)</label><input type="number" id="special-cards-lambda" step="0.1" value="4.5"></div>
                                 <div class="input-group"><label for="special-sot-lambda">Oč. Šuteva u Okvir (λ)</label><input type="number" id="special-sot-lambda" step="0.1" value="8.5"></div>
                                <div class="input-group"><label for="special-corners-lambda-home">Oč. Kornera Domaćin</label><input type="number" id="special-corners-lambda-home" step="0.1" readonly></div>
                                <div class="input-group"><label for="special-corners-lambda-away">Oč. Kornera Gost</label><input type="number" id="special-corners-lambda-away" step="0.1" readonly></div>
                                <div class="input-group"><label for="special-gg-prob">GG Verovatnoća (%)</label><input type="number" id="special-gg-prob" step="0.1" value="55.0"></div>
                                <div class="input-group"><label for="special-penalty-odd">Kvota za Penal</label><input type="number" id="special-penalty-odd" step="0.01" value="3.0"></div>
                                <div class="input-group"><label for="special-red-card-odd">Kvota za Crveni Karton</label><input type="number" id="special-red-card-odd" step="0.01" value="4.0"></div>
                             </div>
                        </section>
                         <section class="mb-8 p-6 bg-slate-50 border border-slate-200 rounded-lg">
                            <h3 class="font-bold text-lg text-slate-800 mb-4">Dodaj Prilagođenu Igru</h3>
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
                                <div class="input-group"><label for="custom-market2">Opis 1</label><input type="text" id="custom-market2" placeholder="Npr. GG"></div>
                                <div class="input-group"><label for="custom-market3">Opis 2</label><input type="text" id="custom-market3" placeholder="Npr. i 3+"></div>
                                <div class="input-group"><label for="custom-odd">Kvota</label><input type="number" id="custom-odd" step="0.01" placeholder="Npr. 1.85"></div>
                                <button type="button" id="add-custom-bet-btn" class="h-10 px-4 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow-md transition-all">Dodaj Igru</button>
                            </div>
                        </section>
                         <section class="mb-8 p-6 bg-slate-50 border border-slate-200 rounded-lg">
                            <h3 class="font-bold text-lg text-slate-800 mb-4">API Podaci za Meč</h3>
                            <button type="button" id="toggle-api-data-btn" class="action-btn secondary !py-2 !px-4 !text-sm mb-4">Prikaži/Sakrij API Podatke</button>
                            <div id="api-data-display" class="hidden bg-white text-slate-700 p-4 rounded-lg border border-slate-200">
                                <pre class="text-xs whitespace-pre-wrap"></pre>
                            </div>
                        </section>
                    </form>
                </div>

                <div class="flex flex-col md:flex-row justify-center items-center gap-4 my-8">
                    <button id="generate-btn" class="w-full md:w-auto action-btn primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-zap"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>
                        <span id="generate-btn-text">Generiši Kvote</span>
                    </button>
                    <button type="button" id="reset-btn" class="w-full md:w-auto action-btn secondary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-cw"><path d="M21 2v6h-6"></path><path d="M3 12a9 9 0 1 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path></svg>
                        Poništi Unos
                    </button>
                </div>

                <div id="preview-section" class="hidden">
                    <h2 class="text-xl sm:text-2xl font-bold text-slate-800 mb-6 text-center">Pregled Generisanih Kvota</h2>
                     <div class="flex items-center justify-between mb-4">
                        <p id="preview-match-name" class="text-sm font-medium text-slate-600"></p>
                        <div class="flex items-center gap-2">
                             <input type="text" id="csv-match-name" placeholder="MATCH_NAME" class="input-group input !w-auto text-sm">
                             <input type="text" id="csv-league-name" placeholder="LEAGUE_NAME" class="input-group input !w-auto text-sm">
                        </div>
                     </div>
                    <div class="overflow-x-auto rounded-lg border border-slate-200">
                        <table class="min-w-full">
                            <thead class="bg-slate-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider">Igrač / Igra</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider">Opis 1</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider">Opis 2</th>
                                    <th scope="col" class="px-6 py-3 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider">Kvota</th>
                                    <th scope="col" class="px-4 py-3 text-center text-xs font-semibold text-slate-600 uppercase tracking-wider">Ukloni</th>
                                </tr>
                            </thead>
                            <tbody id="preview-table-body" class="bg-white"></tbody>
                        </table>
                    </div>
                    <div class="flex justify-center mt-8">
                        <button id="download-csv-btn" class="w-full md:w-auto action-btn success">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-download-cloud"><path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"></path><path d="M12 12v9"></path><path d="m8 17 4 4 4-4"></path></svg>
                            Preuzmi CSV
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="/js/main.js" type="module"></script>
</body>
</html>
